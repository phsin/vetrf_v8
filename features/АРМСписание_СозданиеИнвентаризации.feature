#language: ru

@tree

Функционал: АРМ Списание - создание документов ВСД2_Инвентаризация

//Создание документов списания через АРМ Списание для реализаций с признаком "ВСД не выписываем"

Как Admin я хочу
списывать товары по реализациям без ВСД через документы инвентаризации
чтобы соответствовать требованиям ФГИС Меркурий

Контекст:
	Дано Я запускаю сценарий открытия TestClient или подключаю уже существующий
	И я закрываю все окна клиентского приложения

Сценарий: Создание реализации с признаком "ВСД не выписываем"
	И В командном интерфейсе я выбираю "Типовые документы и справочники" "Реализация товаров и услуг"
	Тогда открылось окно "Реализация товаров и услуг"
	И я нажимаю на кнопку с именем 'ФормаСоздать'

	И из выпадающего списка с именем 'Организация' я выбираю по строке "Основная организация"
	И из выпадающего списка с именем 'Контрагент' я выбираю по строке "Энергия"
	И из выпадающего списка с именем 'Склад' я выбираю по строке "Основной склад"
	И я устанавливаю флаг с именем 'ВСДНеВыписываем'
	И в поле с именем 'Комментарий' я ввожу текст "Тест АРМ Списание"

	И в таблице 'Товары' я нажимаю на кнопку с именем 'ТоварыДобавить'
	И в таблице 'Товары' из выпадающего списка с именем 'ТоварыНоменклатура' я выбираю по строке "Молоко"
	И в таблице 'Товары' я активизирую поле с именем 'ТоварыКоличество'
	И в таблице 'Товары' в поле с именем 'ТоварыКоличество' я ввожу текст "50"
	И в таблице 'Товары' я активизирую поле с именем 'ТоварыЦена'
	И в таблице 'Товары' в поле с именем 'ТоварыЦена' я ввожу текст "45,00"
	И в таблице 'Товары' я активизирую поле с именем 'ТоварыСумма'
	И в таблице 'Товары' в поле с именем 'ТоварыСумма' я ввожу текст "2250,00"
	И в таблице 'Товары' я завершаю редактирование строки

	И я нажимаю на кнопку с именем 'ФормаПровестиИЗакрыть'

Сценарий: Открытие обработки АРМ Списание
	И В командном интерфейсе я выбираю "кб99 ВСД" "АРМ Списание"
	Тогда открылось окно "АРМ Списание товаров"

Сценарий: Заполнение списка реализаций
	И из выпадающего списка с именем 'Организация' я выбираю по строке "Основная организация"
	И в поле с именем 'ДатаНачала' я ввожу значение начала текущего месяца
	И в поле с именем 'ДатаОкончания' я ввожу значение конца текущего месяца
	И я нажимаю на кнопку с именем 'ФормаЗаполнить'

	Тогда таблица 'Реализации' стала равной:
		| Дата         | Номер | Контрагент | Склад           | Проведен |
		| Текущая дата | *     | Энергия    | Основной склад  | Да       |

Сценарий: Отметка документов для списания
	И в таблице 'Реализации' я перехожу к первой строке
	И я нажимаю на кнопку с именем 'ФормаОтметитьВсе'

	Тогда в таблице 'Реализации' поле с именем 'РеализацииОтметка' имеет значение "Да"

Сценарий: Создание документов списания
	И я нажимаю на кнопку с именем 'ФормаСписать'

	Тогда я жду появления сообщения "Создан документ: ВСД2_Инвентаризация *" в течение 10 секунд
	И я жду появления сообщения "Успешно создано документов списания: 1" в течение 5 секунд

Сценарий: Проверка созданного документа ВСД2_Инвентаризация
	И В командном интерфейсе я выбираю "кб99 ВСД" "ВСД2 инвентаризация"
	Тогда открылось окно "ВСД2 инвентаризация"

	И в таблице "Список" я перехожу к последней строке
	И в таблице "Список" я выбираю текущую строку

	Тогда открылось окно "ВСД2 инвентаризация * от *"

	И элемент формы с именем 'Организация' стал равен "Основная организация"
	И элемент формы с именем 'Владелец_ХозСубъект' заполнен
	И элемент формы с именем 'Владелец_площадка' заполнен
	И элемент формы с именем 'ПричинаРасхождения' стал равен "Списание по реализации без ВСД"

	И в таблице 'Продукция' количество строк больше 0

	Тогда элемент формы с именем 'ПродукцияПродукция_Элемент' в таблице 'Продукция' содержит текст "Молоко"
	И элемент формы с именем 'ПродукцияКоличество' в таблице 'Продукция' равен "0"
