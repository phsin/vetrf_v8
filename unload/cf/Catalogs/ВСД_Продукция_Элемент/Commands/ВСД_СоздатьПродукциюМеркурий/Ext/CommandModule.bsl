&НаСервере
Процедура ВыполнитьНаСервере(ПараметрКоманды)
	
	Для Каждого Элемент Из ПараметрКоманды Цикл
		Если ЗначениеЗаполнено(Элемент.Площадка) Тогда
			Организация = кб99_ВСД.ПолучитьОрганизациюПоХС(элемент.Площадка.ХозСубъект);		
		Иначе
			кб99_ВСД.СообщитьИнфо("Проверьте заполнение площадки производителя");
			Продолжить;
		КонецЕсли;
		
		ПараметрыОрганизации = кб99_ВСД.ЗагрузитьПараметры( Организация );
	
		кб99_ВСД_Запросы.Продукция_Элемент_Изменить( ПараметрыОрганизации, элемент, "CREATE" );
	КонецЦикла;

КонецПроцедуры

&НаКлиенте
Процедура ОбработкаОтвета(Ответ, ПараметрФункции) Экспорт
	
	Если Ответ = КодВозвратаДиалога.Да Тогда
		ПоказатьОповещениеПользователя("Выполняем запрос Создание Продукции",,"Ожидайте...",БиблиотекаКартинок.kb99_wrench);
		
		ВыполнитьНаСервере( ПараметрФункции.ПараметрКоманды );
			
		ПараметрФункции.ПараметрыВыполненияКоманды.Источник.ЭтаФорма.ОбновитьОтображениеДанных();	
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	ТВопроса = "Создать Продукцию в Меркурий ?";
	ПараметрПроцедуры = Новый Структура("ПараметрКоманды,ПараметрыВыполненияКоманды", ПараметрКоманды, ПараметрыВыполненияКоманды);
    Оповещение = Новый ОписаниеОповещения("ОбработкаОтвета", ЭтотОбъект, ПараметрПроцедуры);	
    ПоказатьВопрос(Оповещение, ТВопроса, РежимДиалогаВопрос.ДаНет,  0, КодВозвратаДиалога.Да, ""   );
	
КонецПроцедуры
